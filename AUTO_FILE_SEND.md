# è‡ªåŠ¨æ–‡ä»¶å‘é€åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

å½“ `/home/ccp` ç›®å½•ä¸‹çš„ `.md` æ–‡ä»¶è¢«**æ–°å»ºæˆ–ä¿®æ”¹**æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†è¯¥æ–‡ä»¶å‘é€åˆ°**å½“å‰æ­£åœ¨å¯¹è¯çš„é£ä¹¦ç¾¤èŠ**ã€‚

## å·¥ä½œåŸç†

### 1. æ–‡ä»¶ç›‘æ§
- ç›‘æ§ç›®å½•ï¼š`/home/ccp`
- ç›‘æ§æ–‡ä»¶ç±»å‹ï¼š`**/*.md`ï¼ˆæ‰€æœ‰å­ç›®å½•çš„ md æ–‡ä»¶ï¼‰
- ç›‘æ§äº‹ä»¶ï¼š
  - æ–°å»ºæ–‡ä»¶ï¼ˆ`add`ï¼‰
  - ä¿®æ”¹æ–‡ä»¶ï¼ˆ`change`ï¼‰

### 2. æ’é™¤ç›®å½•
ä»¥ä¸‹ç›®å½•è¢«è‡ªåŠ¨æ’é™¤ï¼Œä¸ä¼šè§¦å‘è‡ªåŠ¨å‘é€ï¼š
- `node_modules/`
- `.git/`
- `feicc/`ï¼ˆä¼šè¯æ–‡ä»¶ç›®å½•ï¼‰
- `.claude/`
- `dist/`
- `build/`

### 3. æ™ºèƒ½é˜²æŠ–
- å»¶è¿Ÿæ—¶é—´ï¼š3 ç§’
- ä½œç”¨ï¼šè¿ç»­ç¼–è¾‘åŒä¸€æ–‡ä»¶æ—¶ï¼Œåªå‘é€æœ€åä¸€æ¬¡ä¿å­˜çš„ç‰ˆæœ¬
- ç¤ºä¾‹ï¼šä½ ç¼–è¾‘ `test.md` å¹¶è¿ç»­ä¿å­˜ 3 æ¬¡ï¼Œåªä¼šå‘é€ 1 æ¬¡

### 4. å»é‡æœºåˆ¶
- 1 åˆ†é’Ÿå†…ï¼ŒåŒä¸€æ–‡ä»¶çš„åŒä¸€ç±»å‹å˜åŒ–åªå‘é€ä¸€æ¬¡
- é¿å…é‡å¤å‘é€

### 5. å½“å‰å¯¹è¯è¯†åˆ«
- ç³»ç»Ÿè‡ªåŠ¨è¿½è¸ªæœ€åæ´»è·ƒçš„é£ä¹¦å¯¹è¯
- æ¯æ¬¡ä½ å‘æ¶ˆæ¯ç»™æœºå™¨äººæ—¶ï¼Œè¯¥å¯¹è¯è¢«æ ‡è®°ä¸º"å½“å‰å¯¹è¯"
- æ–‡ä»¶ä¼šå‘é€åˆ°è¿™ä¸ª"å½“å‰å¯¹è¯"

## ä½¿ç”¨æµç¨‹

### æ­¥éª¤ 1ï¼šå¯åŠ¨é£ä¹¦æœåŠ¡
```bash
npm run feishu
```

### æ­¥éª¤ 2ï¼šåœ¨é£ä¹¦ä¸­å‘æ¶ˆæ¯
```
ä½ : hi
æœºå™¨äºº: ğŸ¤” æ”¶åˆ°ï¼Œæ­£åœ¨æ€è€ƒ...
```
æ­¤æ—¶ï¼Œä½ çš„å¯¹è¯è¢«æ ‡è®°ä¸º"å½“å‰å¯¹è¯"ã€‚

### æ­¥éª¤ 3ï¼šç¼–è¾‘æˆ–åˆ›å»º MD æ–‡ä»¶
åœ¨ `/home/ccp` ç›®å½•ä¸‹ï¼š
```bash
echo "# æµ‹è¯•æ–‡æ¡£" > test.md
```

### æ­¥éª¤ 4ï¼šè‡ªåŠ¨æ”¶åˆ°æ–‡ä»¶
é£ä¹¦ä¸­ä¼šæ”¶åˆ°ï¼š
```
æœºå™¨äºº: ğŸ“ æ£€æµ‹åˆ°æ–‡ä»¶æ–°å»º: test.md (0.02KB)
        æ­£åœ¨è‡ªåŠ¨å‘é€...
æœºå™¨äºº: [æ–‡ä»¶: test.md]
```

## å®é™…åœºæ™¯

### åœºæ™¯ 1ï¼šåˆ›å»ºæ–°æ–‡æ¡£
```bash
cd /home/ccp
echo "# é¡¹ç›®è¯´æ˜" > PROJECT.md
```
â†’ é£ä¹¦è‡ªåŠ¨æ”¶åˆ° `PROJECT.md`

### åœºæ™¯ 2ï¼šä¿®æ”¹ç°æœ‰æ–‡æ¡£
```bash
echo "## æ›´æ–°å†…å®¹" >> PROJECT.md
```
â†’ é£ä¹¦è‡ªåŠ¨æ”¶åˆ°æ›´æ–°åçš„ `PROJECT.md`

### åœºæ™¯ 3ï¼šåœ¨å­ç›®å½•åˆ›å»º
```bash
mkdir docs
echo "# API æ–‡æ¡£" > docs/API.md
```
â†’ é£ä¹¦è‡ªåŠ¨æ”¶åˆ° `docs/API.md`

### åœºæ™¯ 4ï¼šClaude ç”Ÿæˆæ–‡ä»¶
å½“ä½ è®© Claude ç”Ÿæˆ md æ–‡ä»¶æ—¶ï¼š
```
ä½ : å¸®æˆ‘ç”Ÿæˆä¸€ä¸ª README.md
Claude: [ç”Ÿæˆ README.md]
```
â†’ é£ä¹¦**è‡ªåŠ¨æ”¶åˆ°** `README.md`

## é…ç½®é€‰é¡¹

åœ¨ `server/feishu-ws.js` ä¸­çš„åˆå§‹åŒ–ä»£ç ï¼š

```javascript
this.fileWatcher = new FeishuFileWatcher(watchPath, {
  enabled: true,           // å¯ç”¨/ç¦ç”¨ï¼ˆé»˜è®¤ trueï¼‰
  debounceDelay: 3000     // é˜²æŠ–å»¶è¿Ÿï¼ˆé»˜è®¤ 3000msï¼‰
});
```

### ç¦ç”¨è‡ªåŠ¨å‘é€
å°† `enabled` è®¾ç½®ä¸º `false`ï¼š
```javascript
this.fileWatcher = new FeishuFileWatcher(watchPath, {
  enabled: false
});
```

### è°ƒæ•´å»¶è¿Ÿæ—¶é—´
æ”¹å˜ `debounceDelay`ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ï¼š
```javascript
this.fileWatcher = new FeishuFileWatcher(watchPath, {
  debounceDelay: 5000  // 5ç§’
});
```

## æ—¥å¿—ç¤ºä¾‹

### æ­£å¸¸è¿è¡Œ
```
[FileWatcher] Initialized
[FileWatcher] Watch path: /home/ccp
[FileWatcher] Enabled: true
[FileWatcher] Ready and watching for changes
[FileWatcher] Active chat updated: oc_xxx
[FileWatcher] File created: test.md
[FileWatcher] Auto-sending file: test.md
[FeishuClient] Uploading file: test.md (0.02KB)
[FeishuClient] File uploaded successfully
[FileWatcher] File sent successfully
```

### æ— æ´»è·ƒå¯¹è¯
```
[FileWatcher] File created: test.md
[FileWatcher] No active chat, skipping auto-send
```

### å‘é€å¤±è´¥
```
[FileWatcher] Failed to send file: File not found
```

## å¸¸è§é—®é¢˜

### Q: æ–‡ä»¶æ²¡æœ‰è‡ªåŠ¨å‘é€ï¼Ÿ
A: æ£€æŸ¥ï¼š
1. æ˜¯å¦å¯åŠ¨äº†é£ä¹¦æœåŠ¡ï¼ˆ`npm run feishu`ï¼‰
2. æ˜¯å¦å…ˆåœ¨é£ä¹¦ä¸­å‘è¿‡æ¶ˆæ¯ï¼ˆå»ºç«‹å½“å‰å¯¹è¯ï¼‰
3. æ–‡ä»¶æ˜¯å¦åœ¨æ’é™¤ç›®å½•ä¸­ï¼ˆå¦‚ `feicc/`ï¼‰
4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

### Q: æ–‡ä»¶å‘é€å¤ªé¢‘ç¹ï¼Ÿ
A: å¢åŠ  `debounceDelay` çš„å€¼ï¼Œä¾‹å¦‚æ”¹ä¸º 5000ï¼ˆ5ç§’ï¼‰

### Q: æƒ³ä¸´æ—¶ç¦ç”¨è‡ªåŠ¨å‘é€ï¼Ÿ
A: è®¾ç½® `enabled: false` å¹¶é‡å¯æœåŠ¡

### Q: æ–‡ä»¶å‘é€åˆ°é”™è¯¯çš„ç¾¤ï¼Ÿ
A: åœ¨æ­£ç¡®çš„ç¾¤ä¸­ç»™æœºå™¨äººå‘ä¸€æ¡æ¶ˆæ¯ï¼Œæ›´æ–°"å½“å‰å¯¹è¯"

## å®‰å…¨è¯´æ˜

- ä¸éœ€è¦ `sudo` æƒé™
- åªç›‘æ§ md æ–‡ä»¶ï¼Œä¸æ¶‰åŠç³»ç»Ÿæ–‡ä»¶
- åªå‘é€åˆ°ä½ ä¸»åŠ¨å¯¹è¯çš„é£ä¹¦ç¾¤
- å¯éšæ—¶é€šè¿‡é…ç½®ç¦ç”¨

## æŠ€æœ¯æ¶æ„

```
æ–‡ä»¶ç³»ç»Ÿå˜åŒ–
    â†“
chokidar ç›‘æ§
    â†“
FeishuFileWatcher å¤„ç†
    â†“
é˜²æŠ– + å»é‡
    â†“
è·å–å½“å‰æ´»è·ƒå¯¹è¯
    â†“
FeishuClient ä¸Šä¼  + å‘é€
    â†“
é£ä¹¦ç¾¤èŠæ”¶åˆ°æ–‡ä»¶
```
